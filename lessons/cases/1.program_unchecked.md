https://x.com/xiaowan72555080/status/1995790813616542193


Advent of Bugs day 1: PDA impersonation

During our initial audit of MetaDAO’s launchpad in march, we stumbled upon a sneaky bug due to missing PDA validation.

When initializing a new launch, the program expected a launch_signer which would receive the newly minted tokens to their token account. This account was supposed to be the launch Mint's existing mint authority and a PDA at the seed "launch_signer" + launch.key().
However, the instruction didn’t check the account address being this PDA. Instead, the program relied on passing the launch_signer with seeds into the MintTo instruction using invoke_signed, assuming that this would only work with the correct launch_signer PDA.

We found that an arbitrary Solana account can be passed as the launch_signer as long as it is also a signer of the top level transaction, and it’s the given mint authority.

As there is no explicit PDA address check, the minting using this launch_signer would still work, as the signature for this account exists on the top level of the instruction, while the passed seeds will be ignored if they don’t match any given account.

The attack sequence would work like this:

• create a new mint, set our own keypair K as the mint authority
• create token account for K
• call InitializeLaunch with K as launch_signer, including a signature for K
• program mints tokens to our launch account
• to cover our tracks, transfer most tokens and the mint authority to the original intended launch_signer PDA, proceed with normal launch, while we have backdoor-minted our own allocation

The lesson: when signing for a PDA, always confirm that the account you intend to sign for is actually that PDA.