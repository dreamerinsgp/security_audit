Advent of Bugs day 2: LaunchPool timing issue: End time == Claim time

During one of many launchpad audits this year, we found a critical timing issue in the transition from collection of funds to the claiming of tokens. In particular, this one launchpad had an end time that was equal to the start of the claim time.

When a system has multiple states (start → end → claim → …), each state must be strictly separated. This meant that for one slot, when end_time  claim_time  current slot, you could still deposit funds, withdraw funds, update your deposit, but then also claim tokens from the launch!

This leads to incorrect reward distribution. Claims depend on each user’s deposit amount and the total deposit. If someone claims while others can still deposit/withdraw/update, the proportions can be changed at the same time as the claim.

This becomes worse if someone uses a flash loan:

• Borrow tokens
• Deposit exactly at end_time == claim_time
• Claim rewards immediately
• Withdraw their deposit
• Return flash loan
They only pay a small fee but still receive all claim tokens.

The root cause was that the code used a <= check instead of a < when checking the current time before processing deposit or claim related actions. This meant that the following state transition was defined: start < end <= claim_start , which allowed two states to be active for one slot. The takeaway: When using time as a state transition trigger, ensure that each timestamp maps to one distinct state!